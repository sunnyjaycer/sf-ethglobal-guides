# Super Agreements

It's hard to understand Superfluid without also understanding Super Agreements. There are two agreements you can use today: the Constant Flow Agreement and the Instant Distribution Agreement.

The key thing to understand about agreements is that they help define how Super Token balances can be modified through time. When an address engages with a Super Agreement contract, their balance will be changed according to their interaction with that agreement. For example, if I open up a money stream to Alice at a rate of 1 DAIx per second, I'm really interacting with the Constant Flow Agreement contract under the hood. Because of the specific rules implemented on the CFA contract, the DAIx token contract will know to decrement my balance by that amount every second that the stream is open. 

The same concept holds true for the Instant Distribution Agreement as well, but it works a bit differently as the IDA is not associated with time, but rather an index that a `publisher` can distribute funds to. Let's dive a bit deeper into each agreement.

## Money Streams and the Constant Flow Agreement (CFA)

When an account opens a money stream using the Constant Flow Agreement, they need to define the receiver, the super token being streamed, and the flow rate of that stream. For example, in our sdk, it looks like this:

```
sf.cfaV1.createFlow({
	receiver: ‚Äú0x123‚Ä¶‚Äù,
	superToken: daix.address,
	flowRate: ‚Äú385802469135802‚Äù //equivalent to 1000 dai per month
});
```

üí° Note that the flow rate is the number of tokens that the user will send per second to the receiver (denominated in wei: i.e. with 18 decimals)


When this stream is opened, 4 hours worth of that stream is held in escrow by the protocol. This is known as the stream‚Äôs *buffer.* The buffer is a mechanism to help keep Superfluid secure. With Superfluid streams, you don‚Äôt need to lock up the entire stream amount up front. You can learn more about why this works the way that it does [here](https://docs.superfluid.finance/superfluid/sentinels/liquidations-and-toga), but it‚Äôs worth keeping that buffer amount in mind.

For example, as long as I have at least 4 hours worth of the stream in my balance, I can open the above stream at 1000/month. Having all 1k tokens in my wallet is unnecessary: I can keep them working in Aave or Compound, and then periodically top up my wallet balance. 

**Calculating Balances with the CFA**

An account can be sending and receiving an arbitrary number of streams at any given point in time. However, one crucial thing to understand is the concept of a **net flow rate**.

The `netFlowRate` is the total number of tokens being sent or received each second. Accounts will have different net flow rates for each token depending on their streaming activity. Super Token balances take into consideration net flow rates when calculating a user‚Äôs real time balance. 

The protocol is able to use netFlowRate & the number of seconds that have passed since it was last changed to figure out how many tokens an account should have at any given point in time. We can rely on the blockchain itself to generate new block.timestamp values for us. By multiplying the number of seconds between state changes by an account‚Äôs netFlowRate, we can effectively update user balances in real time, all without having to manually call `transfer` every second! Pretty clever huh?


üí° You can see several visual examples of this process in [this section of our documentation](https://docs.superfluid.finance/superfluid/protocol-overview/in-depth-overview/super-agreements/constant-flow-agreement-cfa).


## Instant Distributions and the Instant Distribution Agreement (IDA)

The instant distribution agreement (IDA) allows users to send one-to-many transfers in a scalable way with a single transaction. The IDA allows a `publisher` to create an `index`, and grant `units` of this index to `subscribers`. Once units are given, a publisher can `distribute` a number of super tokens to the index. These super tokens will be automatically distributed to each subscriber in amounts that are proportional to the number of units each subscriber has been granted relative to the total number of outstanding units.

After funds are distributed, subscribers can call `claim()` to receive all tokens distributed to them so far through that index. Calling `approveSubscription()` will give a user all funds distributed so far, and will allow them to automatically receive all funds distributed in the future without having to call `claim()` at all.

üí° You can see a full visual example of an Instant Distribution in action using [this section](https://docs.superfluid.finance/superfluid/protocol-overview/in-depth-overview/super-agreements/instant-distribution-agreement-ida) of our docs. 
